{% extends 'restau/base.html' %}
{% block content %}
<div class="section-content-wide formset-update">
  {% if subformset %}
  <div class="content">
    <form method="post">
      {% csrf_token %}

      {{ formset.management_form }}
      {{ subformset.management_form }}

      <table>
          <thead>
              <tr>
                  <th>Categoria</th>
                  <th>Subcategoria</th>
                  <th>Ordem</th>
              </tr>
          </thead>
          <tbody>
            {% for i in formset.forms %}
          <tr>
            <td>{{ i.instance.nome }}</td>
            <td>
          </tr>
          {% for subform in subformset.forms %}                        
            {% if subform.categoria.value == i.id.value %}
          <tr>
            <td>{{ subform.id }}</td>
            <td>
              <a href="{% url 'restau:subcategory' subform.instance.id %}"> 
              {{ subform.nome }}
              </a>
            </td>
            <td>{{ subform.ordem }}</td>
          </tr>
            
            {% endif %}
          {% endfor %}
          {% endfor %}
          <tr>
            <td></td>
            <td></td>
            <td><button class="btn" type="submit">Salvar</button></td>
          </tr>
        </tbody>  
      </table>
  </form>
  </div>
  {% else %}
  <div class="not-found center">
    <h1>Nada encontrado</h1>
      <p>
        Não encontrei nada nesse link, clique em outro
        link do nosso admin ou vá para a
        <a href="{% url 'restau:index' %}">Home</a>
      </p>
  </div>
</div>
{% endif %}
<div class="content form-wrapper"> 
  <h3 class="center">Adicionar Subcategoria</h3>
  <form 
  action="{{ form_action }}"
  method="POST"
  enctype="multipart/form-data"
  >
    {% csrf_token %}
    <div class="form-content">
      {% for field in form %}
      
      <div class="form-group">
        <label for="{{ field.id_for_label }}">{{ field.label }}</label>
        {{ field }}
        {{ field.errors }}
        {% if field.help_text %}
        <p class="help-text">{{ field.help_text }}</p>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% if form.non_field_errors %}
    <div class="form-content">
      <div class="">
        <div class="message error">
          {{ form.non_field_errors }}
        </div>
      </div>
    </div>
    {% endif %}
    <div class="form-content">
      <div class="form-group">
        <button class="btn" type="submit">Enviar</button>
      </div>
    </div>  
  </form>
</div> 
{% endblock content %}
  
  