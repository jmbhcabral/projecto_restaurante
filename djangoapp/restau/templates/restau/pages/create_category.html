{% extends 'restau/base.html' %}
{% block content %}
<div class="section-content-wide formset-update">
  {% if formset %}
  <div class="content">
    <form action="{% url 'restau:create_category' %}" method="post">
      {% csrf_token %}
      {{ formset.management_form }}
      <table class="">
        <h3 class="center">Categorias</h3>
        <thead>
          <tr class="">
            <th class=""></th>
            <th class="">Categoria</th>
            <th class="">Ordem</th>
          </tr>
        </thead>
      
        <tbody>
          {% for form in formset %}
          <tr class="">
            <td class="t">
              {{ form.id }}
            </td>
            <td class="">
                {{ form.instance.nome }}
            </td>
            <td class="">
              {{ form.ordem }}
            </td>
          </tr>
          {% endfor %}
          <tr>
            <td></td>
            <td> </td>
            <td>
              <button class="btn" type="submit">Update</button>
            </td>
          </tr>
        </tbody>
      </table>
    </form>
  </div>
  {% else %}
  <div class="not-found center">
    <h1>Nada encontrado ðŸ˜ž</h1>
    <p>
      NÃ£o encontrei nada nesse link, clique em outro
      link do nosso admin ou vÃ¡ para a
      <a href="{% url 'restau:index' %}">Home</a>
    </p>
  </div>
  {% endif %}
  {% if subformset %}
  <div class="content">
    <form method="post">
      {% csrf_token %}

      {{ formset.management_form }}
      {{ subformset.management_form }}

      <table>
          <thead>
              <tr>
                  <th>Categoria</th>
                  <th>Subcategoria</th>
                  <th>Ordem</th>
              </tr>
          </thead>
          <tbody>
            {% for i in formset.forms %}
          <tr>
            <td>{{ i.instance.nome }}</td>
            <td>
          </tr>
          {% for subform in subformset.forms %}                        
            {% if subform.categoria.value == i.id.value %}
          <tr>
            <td>{{ subform.id }}</td>
            <td>{{ subform.instance.nome }}</td>
            <td>{{ subform.ordem }}</td>
          </tr>
            
            {% endif %}
          {% endfor %}
          {% if not subform.categoria.value == i.id.value %}
          <tr>
            <td>sem dados</td>
          </tr>
          {% endif %}
          {% endfor %}
          <tr>
            <td></td>
            <td></td>
            <td><button class="btn" type="submit">Salvar</button></td>
          </tr>
        </tbody>  
      </table>
  </form>
    {% comment %} <form action="{% url 'restau:create_category' %}" method="post">
      {% csrf_token %}
      {{ subformset.management_form }}
      <table class="">
        <h3>SubCategorias</h3>
        <thead>
          <tr class="">
            <th class=""></th>
            <th class="">SubCategoria</th>
            <th class="">Ordem</th>
          </tr>
        </thead> 
        <tbody>
          {% for form in subformset %}
          <tr class=""><h3>{{ form.category }}</h3></tr>
          <tr class="">
            <td class="">
              {{ form.id }}
            </td>
            <td class="">
                {{ form.nome }}
            </td>
            <td class="">
              {{ form.ordem }}
            </td>
          </tr>
          {% endfor %}
          <tr>
            <td></td>
            <td></td>
            <td>
              <button class="btn" type="submit">Update</button>
            </td>
          </tr>
        </tbody>
      </table>
    </form> {% endcomment %}
  </div>
  {% else %}
  <div class="not-found center">
    <h1>Nada encontrado ðŸ˜ž</h1>
      <p>
        NÃ£o encontrei nada nesse link, clique em outro
        link do nosso admin ou vÃ¡ para a
        <a href="{% url 'restau:index' %}">Home</a>
      </p>
  </div>
</div>
{% endif %}
<div class="content form-wrapper"> 
  <h3>Adicionar Categoria</h3>
  <form 
  action="{{ form_action }}"
  method="POST"
  enctype="multipart/form-data"
  >
    {% csrf_token %}
    <div class="form-content">
      {% for field in form %}
      
      <div class="form-group">
        <label for="{{ field.id_for_label }}">{{ field.label }}</label>
        {{ field }}
        {{ field.errors }}
        {% if field.help_text %}
        <p class="help-text">{{ field.help_text }}</p>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% if form.non_field_errors %}
    <div class="form-content">
      <div class="">
        <div class="message error">
          {{ form.non_field_errors }}
        </div>
      </div>
    </div>
    {% endif %}
    <div class="form-content">
      <div class="form-group">
        <button class="btn" type="submit">Enviar</button>
      </div>
    </div>  
  </form>
</div> 
{% endblock content %}
  
  